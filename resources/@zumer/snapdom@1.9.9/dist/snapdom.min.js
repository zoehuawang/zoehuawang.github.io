(()=>{var Jt=Object.defineProperty,Qt=Object.defineProperties;var Zt=Object.getOwnPropertyDescriptors;var ot=Object.getOwnPropertySymbols;var At=Object.prototype.hasOwnProperty,$t=Object.prototype.propertyIsEnumerable;var Et=(t,e,r)=>e in t?Jt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,L=(t,e)=>{for(var r in e||(e={}))At.call(e,r)&&Et(t,r,e[r]);if(ot)for(var r of ot(e))$t.call(e,r)&&Et(t,r,e[r]);return t},kt=(t,e)=>Qt(t,Zt(e));var ft=(t,e)=>{var r={};for(var i in t)At.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&ot)for(var i of ot(t))e.indexOf(i)<0&&$t.call(t,i)&&(r[i]=t[i]);return r};var w=(t,e,r)=>new Promise((i,c)=>{var a=n=>{try{d(r.next(n))}catch(o){c(o)}},f=n=>{try{d(r.throw(n))}catch(o){c(o)}},d=n=>n.done?i(n.value):Promise.resolve(n.value).then(a,f);d((r=r.apply(t,e)).next())});var p={image:new Map,background:new Map,resource:new Map,defaultStyle:new Map,baseStyle:new Map,computedStyle:new WeakMap,font:new Set,snapshot:new WeakMap,snapshotKey:new Map,reset:te};function te(){p.computedStyle=new WeakMap}var ee=["div","span","p","a","img","ul","li","button","input","select","textarea","label","section","article","header","footer","nav","main","aside","h1","h2","h3","h4","h5","h6","svg","path","circle","rect","line","g","table","thead","tbody","tr","td","th"];function It(){for(let t of ee)Rt(t)}function Rt(t){if(p.defaultStyle.has(t))return p.defaultStyle.get(t);if(new Set(["script","style","meta","link","noscript","template","defs","symbol","title","metadata","desc"]).has(t)){let f={};return p.defaultStyle.set(t,f),f}let r=document.getElementById("snapdom-sandbox");r||(r=document.createElement("div"),r.id="snapdom-sandbox",r.style.position="absolute",r.style.left="-9999px",r.style.top="-9999px",r.style.width="0",r.style.height="0",r.style.overflow="hidden",document.body.appendChild(r));let i=document.createElement(t);i.style.all="initial",r.appendChild(i);let c=getComputedStyle(i),a={};for(let f of c)a[f]=c.getPropertyValue(f);return r.removeChild(i),p.defaultStyle.set(t,a),a}var ne=new Set(["-webkit-locale"]);function G(t,e,r=!1){let i=[],c=Rt(e);for(let[a,f]of Object.entries(t))if(!ne.has(a))if(!r)f&&i.push(`${a}:${f}`);else{let d=c[a];f&&f!==d&&i.push(`${a}:${f}`)}return i.sort().join(";")}function Nt(t){let e=new Set;return t.nodeType!==Node.ELEMENT_NODE&&t.nodeType!==Node.DOCUMENT_FRAGMENT_NODE?[]:(t.tagName&&e.add(t.tagName.toLowerCase()),typeof t.querySelectorAll=="function"&&t.querySelectorAll("*").forEach(r=>e.add(r.tagName.toLowerCase())),Array.from(e))}function Tt(t){let e=new Map;for(let i of t){let c=p.defaultStyle.get(i);if(!c)continue;let a=Object.entries(c).map(([f,d])=>`${f}:${d};`).sort().join("");e.has(a)||e.set(a,[]),e.get(a).push(i)}let r="";for(let[i,c]of e.entries())r+=`${c.join(",")} { ${i} }
`;return r}function Ft(t){let e=new Set(t.values()),r=new Map,i=1;for(let c of e)c.trim()&&r.set(c,`c${i++}`);return r}function V(r){return w(this,arguments,function*(t,e={}){let i=J(t),c=/^((repeating-)?(linear|radial|conic)-gradient)\(/i.test(t);if(i){let a=Q(i);if(p.background.has(a))return e.skipInline?void 0:`url(${p.background.get(a)})`;{let f=yield _(a,{useProxy:e.useProxy});return p.background.set(a,f),e.skipInline?void 0:`url("${f}")`}}return t})}function H(t,{fast:e=!1}={}){if(e)return t();"requestIdleCallback"in window?requestIdleCallback(t,{timeout:50}):setTimeout(t,1)}function D(t,e=null){if(!(t instanceof Element))return window.getComputedStyle(t,e);let r=p.computedStyle.get(t);if(r||(r=new Map,p.computedStyle.set(t,r)),!r.has(e)){let i=window.getComputedStyle(t,e);r.set(e,i)}return r.get(e)}function Lt(t){let e=t.replace(/^['"]|['"]$/g,"");if(e.startsWith("\\"))try{return String.fromCharCode(parseInt(e.replace("\\",""),16))}catch(r){return e}return e}function J(t){let e=t.match(/url\((['"]?)(.*?)(\1)\)/);if(!e)return null;let r=e[2].trim();return r.startsWith("#")?null:r}function z(r){return w(this,arguments,function*(t,{useProxy:e=""}={}){function i(c){return w(this,null,function*(){let a=yield fetch(c);if(!a.ok)throw new Error(`[snapdom] Failed to fetch resource: ${c}`);return a})}try{return yield i(t)}catch(c){if(e&&typeof e=="string"){let a=e.replace(/\/$/,"")+Q(t);return i(a)}throw c}})}var q=new Map,dt=new Map;function _(t,{timeout:e=3e3,useProxy:r="",errorTTL:i=8e3}={}){function c(s){try{return new URL(s,window.location.href).origin===window.location.origin?"use-credentials":"anonymous"}catch(h){return"anonymous"}}let a=s=>({ok:!0,data:s}),f=s=>({ok:!1,error:s instanceof Error?s:new Error(String(s))});function d(s){try{return fetch(s,{mode:"cors",credentials:c(s)==="use-credentials"?"include":"omit"}).then(h=>h.ok?h.blob().then(b=>new Promise(g=>{let y=new FileReader;y.onloadend=()=>{let C=y.result;typeof C!="string"||!C.startsWith("data:image/")?g(f(new Error("Invalid image data URL"))):g(a(C))},y.onerror=()=>g(f(new Error("FileReader error"))),y.readAsDataURL(b)})):f(new Error("HTTP "+h.status))).catch(h=>f(h))}catch(h){return Promise.resolve(f(h))}}function n(s){return d(s).then(h=>{if(h.ok)return h;if(r&&typeof r=="string"){let b=r.replace(/\/$/,"")+Q(s);return d(b).then(g=>g.ok?g:f(new Error("[SnapDOM - fetchImage] Fetch failed and no proxy provided")))}return f(new Error("[SnapDOM - fetchImage] Fetch failed and no proxy provided"))})}let o=Date.now(),m=dt.get(t);if(m&&m>o){let s=Promise.reject(new Error("[SnapDOM - fetchImage] Recently failed (cooldown)."));return s.catch(()=>{}),s}if(q.has(t))return q.get(t);let u=c(t);if(p.image.has(t))return Promise.resolve(p.image.get(t));if(t.startsWith("data:image/"))return p.image.set(t,t),Promise.resolve(t);if(/\.svg(\?.*)?$/i.test(t)){let s=w(null,null,function*(){let h=yield w(null,null,function*(){try{let g=yield fetch(t,{mode:"cors",credentials:u==="use-credentials"?"include":"omit"});if(!g.ok)return f(new Error("HTTP "+g.status));let y=yield g.text();return a(`data:image/svg+xml;charset=utf-8,${encodeURIComponent(y)}`)}catch(g){return f(g)}});if(h.ok)return p.image.set(t,h.data),h.data;let b=yield n(t);return b.ok?(p.image.set(t,b.data),b.data):(dt.set(t,o+i),Promise.reject(b.error))});return q.set(t,s),s.finally(()=>q.delete(t)),s.catch(()=>{}),s}let l=new Promise((s,h)=>{let b=!1,g=new Image,y=S=>k=>{b||(b=!0,clearTimeout(v),g.onload=g.onerror=null,S(k))},C=S=>{p.image.set(t,S),s(S)},x=S=>{dt.set(t,Date.now()+i),h(S)},v=setTimeout(y(()=>{n(t).then(S=>{S.ok?C(S.data):x(new Error("Image load timed out"))})}),e);g.crossOrigin=u,g.onload=y(()=>{Promise.resolve(g.decode()).then(()=>{try{let S=document.createElement("canvas");S.width=g.naturalWidth||g.width,S.height=g.naturalHeight||g.height,S.getContext("2d").drawImage(g,0,0,S.width,S.height),C(S.toDataURL("image/png"))}catch(S){n(t).then(k=>{k.ok?C(k.data):x(k.error)})}}).catch(()=>{n(t).then(S=>{S.ok?C(S.data):x(S.error)})})}),g.onerror=y(()=>{n(t).then(S=>{S.ok?C(S.data):x(S.error)})}),g.src=t});return q.set(t,l),l.finally(()=>q.delete(t)),l.catch(()=>{}),l}function ut(t){let e={};for(let r of t)e[r]=t.getPropertyValue(r);return e}function Pt(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}function Bt(t){if(!t||t==="none")return"";let e=t.replace(/translate[XY]?\([^)]*\)/g,"");return e=e.replace(/matrix\(([^)]+)\)/g,(r,i)=>{let c=i.split(",").map(a=>a.trim());return c.length!==6?`matrix(${i})`:(c[4]="0",c[5]="0",`matrix(${c.join(", ")})`)}),e=e.replace(/matrix3d\(([^)]+)\)/g,(r,i)=>{let c=i.split(",").map(a=>a.trim());return c.length!==16?`matrix3d(${i})`:(c[12]="0",c[13]="0",`matrix3d(${c.join(", ")})`)}),e.trim().replace(/\s{2,}/g," ")}function Q(t){if(/%[0-9A-Fa-f]{2}/.test(t))return t;try{return encodeURI(t)}catch(e){return t}}function Y(t){let e=[],r=0,i=0;for(let c=0;c<t.length;c++){let a=t[c];a==="("&&r++,a===")"&&r--,a===","&&r===0&&(e.push(t.slice(i,c).trim()),i=c+1)}return e.push(t.slice(i).trim()),e}var mt=new WeakMap,ht=new Map;function oe(t){let e={},r=t.getPropertyValue("visibility");for(let i=0;i<t.length;i++){let c=t[i],a=t.getPropertyValue(c);(c==="background-image"||c==="content")&&a.includes("url(")&&!a.includes("data:")&&(a="none"),e[c]=a}return r==="hidden"&&(e.opacity="0"),e}function rt(t,e,r,i,c){var m;if(t.tagName==="STYLE")return;i.has(t)||i.set(t,D(t));let a=i.get(t);if(!mt.has(t)){let u=oe(a);mt.set(t,u)}let f=mt.get(t),d=Object.entries(f).sort(([u],[l])=>u.localeCompare(l)).map(([u,l])=>`${u}:${l}`).join(";");if(ht.has(d)){r.set(e,ht.get(d));return}let n=((m=t.tagName)==null?void 0:m.toLowerCase())||"div",o=G(f,n,c);ht.set(d,o),r.set(e,o)}function re(t,e){try{let r=t.currentSrc||t.src||"";if(!r)return;e.setAttribute("src",r),e.removeAttribute("srcset"),e.removeAttribute("sizes"),e.loading="eager",e.decoding="sync"}catch(r){}}function Z(t,e,r,i,c,a={},f){var m,u;if(!t)throw new Error("Invalid node");let d=new Set,n=null;if(t.nodeType===Node.TEXT_NODE||t.nodeType!==Node.ELEMENT_NODE)return t.cloneNode(!0);if(t.getAttribute("data-capture")==="exclude"){let l=document.createElement("div"),s=t.getBoundingClientRect();return l.style.cssText=`display:inline-block;width:${s.width}px;height:${s.height}px;visibility:hidden;`,l}if(a.exclude&&Array.isArray(a.exclude))for(let l of a.exclude)try{if((m=t.matches)!=null&&m.call(t,l)){let s=document.createElement("div"),h=t.getBoundingClientRect();return s.style.cssText=`display:inline-block;width:${h.width}px;height:${h.height}px;visibility:hidden;`,s}}catch(s){console.warn(`Invalid selector in exclude option: ${l}`,s)}if(typeof a.filter=="function")try{if(!a.filter(t,f||t)){let l=document.createElement("div"),s=t.getBoundingClientRect();return l.style.cssText=`display:inline-block;width:${s.width}px;height:${s.height}px;visibility:hidden;`,l}}catch(l){console.warn("Error in filter function:",l)}if(t.tagName==="IFRAME"){let l=document.createElement("div");return l.style.cssText=`width:${t.offsetWidth}px;height:${t.offsetHeight}px;background-image:repeating-linear-gradient(45deg,#ddd,#ddd 5px,#f9f9f9 5px,#f9f9f9 10px);display:flex;align-items:center;justify-content:center;font-size:12px;color:#555;border:1px solid #aaa;`,l}if(t.getAttribute("data-capture")==="placeholder"){let l=t.cloneNode(!1);i.set(l,t),rt(t,l,e,r,c);let s=document.createElement("div");return s.textContent=t.getAttribute("data-placeholder-text")||"",s.style.cssText="color:#666;font-size:12px;text-align:center;line-height:1.4;padding:0.5em;box-sizing:border-box;",l.appendChild(s),l}if(t.tagName==="CANVAS"){let l=t.toDataURL(),s=document.createElement("img");return s.src=l,s.width=t.width,s.height=t.height,i.set(s,t),rt(t,s,e,r,c),s}let o;try{o=t.cloneNode(!1),i.set(o,t),t.tagName==="IMG"&&re(t,o)}catch(l){throw console.error("[Snapdom] Failed to clone node:",t,l),l}if(t instanceof HTMLTextAreaElement){o.textContent=t.value,o.value=t.value;let l=t.getBoundingClientRect();return o.style.width=`${l.width}px`,o.style.height=`${l.height}px`,o}if(t instanceof HTMLInputElement&&(o.value=t.value,o.setAttribute("value",t.value),t.checked!==void 0&&(o.checked=t.checked,t.checked&&o.setAttribute("checked",""),t.indeterminate&&(o.indeterminate=t.indeterminate))),t instanceof HTMLSelectElement&&(n=t.value),rt(t,o,e,r,c),t.shadowRoot)if(Array.from(t.shadowRoot.querySelectorAll("slot")).length>0){for(let s of t.shadowRoot.childNodes)if(s.nodeType===Node.ELEMENT_NODE&&s.tagName==="STYLE"){let h=s.textContent||"";h.trim()&&c&&r.set(s,h)}}else{let s=document.createDocumentFragment();for(let h of t.shadowRoot.childNodes){if(h.nodeType===Node.ELEMENT_NODE&&h.tagName==="STYLE"){let g=h.textContent||"";g.trim()&&c&&r.set(h,g);continue}let b=Z(h,e,r,i,c,a,f||t);b&&s.appendChild(b)}o.appendChild(s)}if(t.tagName==="SLOT"){let l=((u=t.assignedNodes)==null?void 0:u.call(t,{flatten:!0}))||[],s=l.length>0?l:Array.from(t.childNodes),h=document.createDocumentFragment();for(let b of s){let g=Z(b,e,r,i,c,a,f||t);g&&h.appendChild(g)}return h}for(let l of t.childNodes){if(d.has(l))continue;let s=Z(l,e,r,i,c,a,f||t);s&&o.appendChild(s)}if(n!==null&&o instanceof HTMLSelectElement){o.value=n;for(let l of o.options)l.value===n?l.setAttribute("selected",""):l.removeAttribute("selected")}return o}var ae=[/font\s*awesome/i,/material\s*icons/i,/ionicons/i,/glyphicons/i,/feather/i,/bootstrap\s*icons/i,/remix\s*icons/i,/heroicons/i,/layui/i,/lucide/i],gt=[];function Ut(t){let e=Array.isArray(t)?t:[t];for(let r of e)r instanceof RegExp?gt.push(r):typeof r=="string"?gt.push(new RegExp(r,"i")):console.warn("[snapdom] Ignored invalid iconFont value:",r)}function U(t){let e=typeof t=="string"?t:"",r=[...ae,...gt];for(let i of r)if(i instanceof RegExp&&i.test(e))return!0;return!!(/icon/i.test(e)||/glyph/i.test(e)||/symbols/i.test(e)||/feather/i.test(e)||/fontawesome/i.test(e))}function Mt(t,e,r,i=32,c="#000"){return w(this,null,function*(){e=e.replace(/^['"]+|['"]+$/g,"");let a=window.devicePixelRatio||1;yield document.fonts.ready;let f=document.createElement("span");f.textContent=t,f.style.position="absolute",f.style.visibility="hidden",f.style.fontFamily=`"${e}"`,f.style.fontWeight=r||"normal",f.style.fontSize=`${i}px`,f.style.lineHeight="1",f.style.whiteSpace="nowrap",f.style.padding="0",f.style.margin="0",document.body.appendChild(f);let d=f.getBoundingClientRect(),n=Math.ceil(d.width),o=Math.ceil(d.height);document.body.removeChild(f);let m=document.createElement("canvas");m.width=n*a,m.height=o*a;let u=m.getContext("2d");return u.scale(a,a),u.font=r?`${r} ${i}px "${e}"`:`${i}px "${e}"`,u.textAlign="left",u.textBaseline="top",u.fillStyle=c,u.fillText(t,0,0),{dataUrl:m.toDataURL(),width:n,height:o}})}function Dt(t){return Array.from(document.styleSheets).some(e=>e.href===t)}function se(t){return new Promise(e=>{if(Dt(t))return e(null);let r=document.createElement("link");r.rel="stylesheet",r.href=t,r.setAttribute("data-snapdom","injected-import"),r.onload=()=>e(r),r.onerror=()=>e(null),document.head.appendChild(r)})}function at(){return w(this,arguments,function*({preCached:t=!1,localFonts:e=[],useProxy:r=""}={}){if(p.resource.has("fonts-embed-css")){if(t){let n=document.createElement("style");n.setAttribute("data-snapdom","embedFonts"),n.textContent=p.resource.get("fonts-embed-css"),document.head.appendChild(n)}return p.resource.get("fonts-embed-css")}let i=new Set;try{for(let n of document.fonts)n.status==="loaded"&&i.add(`${n.family}__${n.weight||"normal"}__${n.style||"normal"}`)}catch(n){}let c=/@import\s+url\(["']?([^"')]+)["']?\)/g,a=[];for(let n of document.querySelectorAll("style")){let o=n.textContent||"",m=Array.from(o.matchAll(c));for(let u of m){let l=u[1];U(l)||Dt(l)||a.push(l)}}yield Promise.all(a.map(se));let f=Array.from(document.querySelectorAll('link[rel="stylesheet"]')).filter(n=>n.href),d="";for(let n of f)try{let m=yield(yield z(n.href,{useProxy:r})).text();if(U(n.href)||U(m))continue;let u=/@font-face[^{}]*{[^}]*}/g,l=m;for(let s of m.match(u)||[]){let h=s.match(/font-family:\s*([^;]+);/i);if(!h)continue;let b=h[1].replace(/['"]/g,"").trim(),g=s.match(/font-weight:\s*([^;]+);/i),y=s.match(/font-style:\s*([^;]+);/i),C=g?g[1].trim():"normal",x=y?y[1].trim():"normal",v=`${b}__${C}__${x}`,S=/url\((["']?)([^"')]+)\1\)/g,k=/url\(/i.test(s),A=/local\(/i.test(s);if(!k&&A)continue;if(!i.has(v)){l=l.replace(s,"");continue}let N=s,T=Array.from(s.matchAll(S));for(let F of T){let M=J(F[0]);if(!M)continue;let E=M;if(!E.startsWith("http")&&!E.startsWith("data:")&&(E=new URL(E,n.href).href),!U(E)){if(p.resource.has(E)){p.font.add(E),N=N.replace(F[0],`url(${p.resource.get(E)})`);continue}if(!p.font.has(E))try{let X=yield(yield z(E,{useProxy:r})).blob(),P=yield new Promise(et=>{let I=new FileReader;I.onload=()=>et(I.result),I.readAsDataURL(X)});p.resource.set(E,P),p.font.add(E),N=N.replace(F[0],`url(${P})`)}catch(K){console.warn("[snapdom] Failed to fetch font resource:",E)}}}l=l.replace(s,N)}d+=l+`
`}catch(o){console.warn("[snapdom] Failed to fetch CSS:",n.href)}for(let n of document.styleSheets)try{if(!n.href||f.every(o=>o.href!==n.href)){for(let o of n.cssRules)if(o.type===CSSRule.FONT_FACE_RULE){let m=o.style.getPropertyValue("src"),u=o.style.getPropertyValue("font-family");if(!m||U(u))continue;let l=o.style.getPropertyValue("font-weight")||"normal",s=o.style.getPropertyValue("font-style")||"normal",h=`${u}__${l}__${s}`,b=/url\((["']?)([^"')]+)\1\)/g,g=/local\((["']?)[^)]+?\1\)/g,y=!!m.match(b),C=!!m.match(g);if(!y&&C){d+=`@font-face{font-family:${u};src:${m};font-style:${s};font-weight:${l};}`;continue}if(!i.has(h))continue;let x=m,v=Array.from(m.matchAll(b));for(let S of v){let k=S[2].trim();if(!k)continue;let A=k;if(!A.startsWith("http")&&!A.startsWith("data:")&&(A=new URL(A,n.href||location.href).href),!U(A)){if(p.resource.has(A)){p.font.add(A),x=x.replace(S[0],`url(${p.resource.get(A)})`);continue}if(!p.font.has(A))try{let T=yield(yield z(A,{useProxy:r})).blob(),F=yield new Promise(M=>{let E=new FileReader;E.onload=()=>M(E.result),E.readAsDataURL(T)});p.resource.set(A,F),p.font.add(A),x=x.replace(S[0],`url(${F})`)}catch(N){console.warn("[snapdom] Failed to fetch font URL:",A)}}}d+=`@font-face{font-family:${u};src:${x};font-style:${s};font-weight:${l};}`}}}catch(o){console.warn("[snapdom] Cannot access stylesheet",n.href,o)}for(let n of document.fonts)if(n.family&&n.status==="loaded"&&n._snapdomSrc){if(U(n.family))continue;let o=n._snapdomSrc;if(!o.startsWith("data:")){if(p.resource.has(n._snapdomSrc))o=p.resource.get(n._snapdomSrc),p.font.add(n._snapdomSrc);else if(!p.font.has(n._snapdomSrc))try{let u=yield(yield z(n._snapdomSrc,{useProxy:r})).blob();o=yield new Promise(l=>{let s=new FileReader;s.onload=()=>l(s.result),s.readAsDataURL(u)}),p.resource.set(n._snapdomSrc,o),p.font.add(n._snapdomSrc)}catch(m){console.warn("[snapdom] Failed to fetch dynamic font src:",n._snapdomSrc);continue}}d+=`@font-face{font-family:'${n.family}';src:url(${o});font-style:${n.style||"normal"};font-weight:${n.weight||"normal"};}`}for(let n of e){if(!n||typeof n!="object")continue;let{family:o,src:m,weight:u="normal",style:l="normal"}=n;if(!o||!m)continue;let s=m;if(s.startsWith("data:"))p.resource.set(m,s),p.font.add(m);else try{let b=yield(yield z(m,{useProxy:r})).blob();s=yield new Promise(g=>{let y=new FileReader;y.onload=()=>g(y.result),y.readAsDataURL(b)}),p.resource.set(m,s),p.font.add(m)}catch(h){console.warn("[snapdom] Failed to load local font:",m);continue}d+=`@font-face{font-family:'${o}';src:url(${s});font-style:${l};font-weight:${u};}`}if(d&&(p.resource.set("fonts-embed-css",d),t)){let n=document.createElement("style");n.setAttribute("data-snapdom","embedFonts"),n.textContent=d,document.head.appendChild(n)}return d})}function pt(t,e,r,i,c){return w(this,null,function*(){var d;if(!(t instanceof Element)||!(e instanceof Element))return;for(let n of["::before","::after","::first-letter"])try{let o=D(t,n);if(!o||typeof o[Symbol.iterator]!="function"||o.content==="none"&&o.backgroundImage==="none"&&o.backgroundColor==="transparent"&&(o.borderStyle==="none"||parseFloat(o.borderWidth)===0)&&(!o.transform||o.transform==="none")&&o.display==="inline")continue;if(n==="::first-letter"){let R=getComputedStyle(t);if(!(o.color!==R.color||o.fontSize!==R.fontSize||o.fontWeight!==R.fontWeight))continue;let W=Array.from(e.childNodes).find(Ct=>{var vt;return Ct.nodeType===Node.TEXT_NODE&&((vt=Ct.textContent)==null?void 0:vt.trim().length)>0});if(!W)continue;let j=W.textContent,lt=j.match(/^([^\p{L}\p{N}\s]*[\p{L}\p{N}](?:['’])?)/u),O=lt==null?void 0:lt[0],Kt=j.slice((O==null?void 0:O.length)||0);if(!O||/[\uD800-\uDFFF]/.test(O))continue;let nt=document.createElement("span");nt.textContent=O,nt.dataset.snapdomPseudo="::first-letter";let Xt=ut(o),Gt=G(Xt,"span",c);r.set(nt,Gt);let xt=document.createTextNode(Kt);e.replaceChild(xt,W),e.insertBefore(nt,xt);continue}let u=o.content,l=/counter\s*\(|counters\s*\(/.test(u)?"- ":Lt(u),s=o.backgroundImage,h=o.backgroundColor,b=o.fontFamily,g=parseInt(o.fontSize)||32,y=parseInt(o.fontWeight)||!1,C=o.color||"#000",x=o.display,v=parseFloat(o.width),S=parseFloat(o.height),k=o.borderStyle,A=parseFloat(o.borderWidth),N=o.transform,T=U(b),F=u!=="none"&&l!=="",M=s&&s!=="none",E=h&&h!=="transparent"&&h!=="rgba(0, 0, 0, 0)",K=x!=="inline"&&(v>0||S>0),X=k&&k!=="none"&&A>0,P=N&&N!=="none";if(!(F||M||E||K||X||P))continue;let I=document.createElement("span");I.dataset.snapdomPseudo=n,I.style.verticalAlign="middle";let it=ut(o),ct=G(it,"span",c);if(r.set(I,ct),T&&l.length===1){let{dataUrl:R,width:B,height:W}=yield Mt(l,b,y,g,C),j=document.createElement("img");j.src=R,j.style=`height:${g}px;width:${B/W*g}px;object-fit:contain;`,I.appendChild(j),e.dataset.snapdomHasIcon="true"}else if(l.startsWith("url(")){let R=J(l);if(R!=null&&R.trim())try{let B=document.createElement("img"),W=yield _(Q(R),c);B.src=W,B.style=`width:${g}px;height:auto;object-fit:contain;`,I.appendChild(B)}catch(B){console.error(`[snapdom] Error in pseudo ${n} for`,t,B)}}else!T&&F&&(I.textContent=l);if(M)try{let R=Y(s),B=yield Promise.all(R.map(V));I.style.backgroundImage=B.join(", ")}catch(R){console.warn(`[snapdom] Failed to inline background-image for ${n}`,R)}if(E&&(I.style.backgroundColor=h),!(I.childNodes.length>0||((d=I.textContent)==null?void 0:d.trim())!==""||M||E||K||X||P))continue;n==="::before"?e.insertBefore(I,e.firstChild):e.appendChild(I)}catch(o){console.warn(`[snapdom] Failed to capture ${n} for`,t,o)}let a=Array.from(t.children),f=Array.from(e.children).filter(n=>!n.dataset.snapdomPseudo);for(let n=0;n<Math.min(a.length,f.length);n++)yield pt(a[n],f[n],r,i,c)})}function Wt(t){if(!t)return;let e=new Set;if(t.querySelectorAll("use").forEach(d=>{let n=d.getAttribute("xlink:href")||d.getAttribute("href");n&&n.startsWith("#")&&e.add(n.slice(1))}),!e.size)return;let r=Array.from(document.querySelectorAll("svg > symbol, svg > defs")),i=r.filter(d=>d.tagName.toLowerCase()==="symbol"),c=r.filter(d=>d.tagName.toLowerCase()==="defs"),a=t.querySelector("svg.inline-defs-container");a||(a=document.createElementNS("http://www.w3.org/2000/svg","svg"),a.setAttribute("aria-hidden","true"),a.setAttribute("style","position: absolute; width: 0; height: 0; overflow: hidden;"),a.classList.add("inline-defs-container"),t.insertBefore(a,t.firstChild));let f=new Set;t.querySelectorAll("symbol[id], defs > *[id]").forEach(d=>{f.add(d.id)}),e.forEach(d=>{if(f.has(d))return;let n=i.find(o=>o.id===d);if(n){a.appendChild(n.cloneNode(!0)),f.add(d);return}for(let o of c){let m=o.querySelector(`#${CSS.escape(d)}`);if(m){let u=a.querySelector("defs");u||(u=document.createElementNS("http://www.w3.org/2000/svg","defs"),a.appendChild(u)),u.appendChild(m.cloneNode(!0)),f.add(d);break}}})}function jt(c){return w(this,arguments,function*(t,e=!1,r=!1,i={}){var m,u;let a=new Map,f=new WeakMap,d=new Map,n,o="";ie(t);try{Wt(t)}catch(l){console.warn("inlineExternal defs or symbol failed:",l)}try{n=Z(t,a,f,d,e,i,t)}catch(l){throw console.warn("deepClone failed:",l),l}try{yield pt(t,n,a,f,e,r,i.useProxy)}catch(l){console.warn("inlinePseudoElements failed:",l)}if(yield de(n),e){let l=Ft(a);o=Array.from(l.entries()).map(([s,h])=>`.${h}{${s}}`).join("");for(let[s,h]of a.entries()){if(s.tagName==="STYLE")continue;if(s.getRootNode&&s.getRootNode()instanceof ShadowRoot){s.setAttribute("style",h.replace(/;/g,"; "));continue}let b=l.get(h);b&&s.classList.add(b);let g=(m=s.style)==null?void 0:m.backgroundImage,y=(u=s.dataset)==null?void 0:u.snapdomHasIcon;g&&g!=="none"&&(s.style.backgroundImage=g),y&&(s.style.verticalAlign="middle",s.style.display="inline")}}else for(let[l,s]of a.entries())l.tagName!=="STYLE"&&l.setAttribute("style",s.replace(/;/g,"; "));for(let[l,s]of d.entries()){let h=s.scrollLeft,b=s.scrollTop;if((h||b)&&l instanceof HTMLElement){l.style.overflow="hidden",l.style.scrollbarWidth="none",l.style.msOverflowStyle="none";let y=document.createElement("div");for(y.style.transform=`translate(${-h}px, ${-b}px)`,y.style.willChange="transform",y.style.display="inline-block",y.style.width="100%";l.firstChild;)y.appendChild(l.firstChild);l.appendChild(y)}}if(t===d.get(n)){let l=f.get(t)||window.getComputedStyle(t);f.set(t,l);let s=Bt(l.transform);n.style.margin="0",n.style.position="static",n.style.top="auto",n.style.left="auto",n.style.right="auto",n.style.bottom="auto",n.style.zIndex="auto",n.style.float="none",n.style.clear="none",n.style.transform=s||""}for(let[l,s]of d.entries())s.tagName==="PRE"&&(l.style.marginTop="0",l.style.marginBlockStart="0");return{clone:n,classCSS:o,styleCache:f}})}function ie(t){let e=getComputedStyle(t),r=e.outlineStyle,i=e.outlineWidth,c=e.borderStyle,a=e.borderWidth,f=r!=="none"&&parseFloat(i)>0,d=c==="none"||parseFloat(a)===0;f&&d&&(t.style.border=`${i} solid transparent`)}var yt=new Map;function tt(t){return w(this,null,function*(){if(yt.has(t))return yt.get(t);let e=yield fetch(t);if(!e.ok)throw new Error(`[SnapDOM] HTTP ${e.status} on blob fetch (${t})`);let r=yield e.blob(),i=yield new Promise((c,a)=>{let f=new FileReader;f.onloadend=()=>{let d=f.result;typeof d=="string"&&d.startsWith("data:")?c(d):a(new Error("[SnapDOM] Invalid data URL from blob"))},f.onerror=()=>a(new Error("[SnapDOM] FileReader error")),f.readAsDataURL(r)});return yt.set(t,i),i})}var ce=/\bblob:[^)"'\s]+/g;function _t(t){return w(this,null,function*(){if(!t||t.indexOf("blob:")===-1)return t;let e=Array.from(new Set(t.match(ce)||[]));if(e.length===0)return t;let r=t;for(let i of e)try{let c=yield tt(i);r=r.split(i).join(c)}catch(c){}return r})}function st(t){return typeof t=="string"&&t.startsWith("blob:")}function le(t){return(t||"").split(",").map(e=>e.trim()).filter(Boolean).map(e=>{let r=e.match(/^(\S+)(\s+.+)?$/);return r?{url:r[1],desc:r[2]||""}:null}).filter(Boolean)}function fe(t){return t.map(e=>e.desc?`${e.url} ${e.desc.trim()}`:e.url).join(", ")}function de(t){return w(this,null,function*(){var f,d;if(!t)return;let e=t.querySelectorAll?t.querySelectorAll("img"):[];for(let n of e)try{let m=n.getAttribute("src")||n.currentSrc||"";if(st(m)){let l=yield tt(m);n.setAttribute("src",l)}let u=n.getAttribute("srcset");if(u&&u.includes("blob:")){let l=le(u),s=!1;for(let h of l)if(st(h.url))try{h.url=yield tt(h.url),s=!0}catch(b){}s&&n.setAttribute("srcset",fe(l))}}catch(o){}let r=t.querySelectorAll?t.querySelectorAll("image"):[];for(let n of r)try{let o="http://www.w3.org/1999/xlink",m=n.getAttribute("href")||((f=n.getAttributeNS)==null?void 0:f.call(n,o,"href"));if(st(m)){let u=yield tt(m);n.setAttribute("href",u),(d=n.removeAttributeNS)==null||d.call(n,o,"href")}}catch(o){}let i=t.querySelectorAll?t.querySelectorAll("[style*='blob:']"):[];for(let n of i)try{let o=n.getAttribute("style");if(o&&o.includes("blob:")){let m=yield _t(o);n.setAttribute("style",m)}}catch(o){}let c=t.querySelectorAll?t.querySelectorAll("style"):[];for(let n of c)try{let o=n.textContent||"";o.includes("blob:")&&(n.textContent=yield _t(o))}catch(o){}let a=["poster"];for(let n of a){let o=t.querySelectorAll?t.querySelectorAll(`[${n}^='blob:']`):[];for(let m of o)try{let u=m.getAttribute(n);st(u)&&m.setAttribute(n,yield tt(u))}catch(u){}}})}function Ot(r){return w(this,arguments,function*(t,e={}){let i=Array.from(t.querySelectorAll("img")),c=a=>w(null,null,function*(){if(!a.getAttribute("src")){let d=a.currentSrc||a.src||"";d&&a.setAttribute("src",d)}a.removeAttribute("srcset"),a.removeAttribute("sizes");let f=a.src;try{let d=yield _(f,{useProxy:e.useProxy});a.src=d,a.width||(a.width=a.naturalWidth||100),a.height||(a.height=a.naturalHeight||100)}catch(d){let n=document.createElement("div");n.style=`width: ${a.width||100}px; height: ${a.height||100}px; background: #ccc; display: inline-block; text-align: center; line-height: ${a.height||100}px; color: #666; font-size: 12px;`,n.innerText="img",a.replaceWith(n)}});for(let a=0;a<i.length;a+=4){let f=i.slice(a,a+4).map(c);yield Promise.allSettled(f)}})}function qt(c,a,f){return w(this,arguments,function*(t,e,r,i={}){let d=[[t,e]],n=["background-image","mask","mask-image","-webkit-mask-image","mask-source","mask-box-image-source","mask-border-source","-webkit-mask-box-image-source","border-image","border-image-source","border-image-slice","border-image-width","border-image-outset","border-image-repeat"];for(;d.length;){let[o,m]=d.shift(),u=r.get(o)||D(o);r.has(o)||r.set(o,u);let l=(()=>{let g=u.getPropertyValue("border-image"),y=u.getPropertyValue("border-image-source");return g&&g!=="none"||y&&y!=="none"})();for(let g of n){if(["border-image-slice","border-image-width","border-image-outset","border-image-repeat"].includes(g)&&!l)continue;let y=u.getPropertyValue(g);if(!y||y==="none")continue;let C=Y(y),x=yield Promise.all(C.map(v=>V(v,i)));x.some(v=>v&&v!=="none"&&!/^url\(undefined/.test(v))&&m.style.setProperty(g,x.join(", "))}let s=u.getPropertyValue("background-color");s&&s!=="transparent"&&s!=="rgba(0, 0, 0, 0)"&&(m.style.backgroundColor=s);let h=Array.from(o.children),b=Array.from(m.children);for(let g=0;g<Math.min(h.length,b.length);g++)d.push([h[g],b[g]])}})}function Vt(r){return w(this,arguments,function*(t,e={}){if(!t)throw new Error("Element cannot be null or undefined");p.reset();let{compress:i=!0,embedFonts:c=!1,fast:a=!0,scale:f=1,useProxy:d="",localFonts:n=[]}=e,o,m,u,l="",s="",h,b;if({clone:o,classCSS:m,styleCache:u}=yield jt(t,i,c,e),yield new Promise(y=>{H(()=>w(null,null,function*(){yield Ot(o,e),y()}),{fast:a})}),yield new Promise(y=>{H(()=>w(null,null,function*(){yield qt(t,o,u,e),y()}),{fast:a})}),c&&(yield new Promise(y=>{H(()=>w(null,null,function*(){l=yield at({localFonts:n,useProxy:d}),y()}),{fast:a})})),i){let y=Nt(o).sort(),C=y.join(",");p.baseStyle.has(C)?s=p.baseStyle.get(C):yield new Promise(x=>{H(()=>{s=Tt(y),p.baseStyle.set(C,s),x()},{fast:a})})}yield new Promise(y=>{H(()=>{let C=t.getBoundingClientRect(),x=C.width,v=C.height,S=Number.isFinite(e.width),k=Number.isFinite(e.height),A=typeof f=="number"&&f!==1;if(!A){let P=C.width/C.height;S&&k?(x=e.width,v=e.height):S?(x=e.width,v=x/P):k&&(v=e.height,x=v*P)}if(x=Math.ceil(x),v=Math.ceil(v),o.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),o.style.transformOrigin="top left",!A&&(S||k)){let P=C.width,et=C.height,I=x/P,it=v/et,ct=o.style.transform||"",St=`scale(${I}, ${it})`;o.style.transform=`${St} ${ct}`.trim()}let N="http://www.w3.org/2000/svg",T=document.createElementNS(N,"foreignObject");T.setAttribute("width","100%"),T.setAttribute("height","100%");let F=document.createElement("style");F.textContent=s+l+"svg{overflow:visible;}"+m,T.appendChild(F),T.appendChild(o);let E=new XMLSerializer().serializeToString(T);b=`<svg xmlns="${N}" width="${x}" height="${v}" viewBox="0 0 ${x} ${v}">`+E+"</svg>",h=`data:image/svg+xml;charset=utf-8,${encodeURIComponent(b)}`,y()},{fast:a})});let g=document.getElementById("snapdom-sandbox");return g&&g.style.position==="absolute"&&g.remove(),h})}function ue(r){return w(this,arguments,function*(t,{scale:e=1}={}){let i=new Image;return i.src=t,yield i.decode(),e!==1&&(i.style.width=`${i.naturalWidth*e}px`,i.style.height=`${i.naturalHeight*e}px`),i})}function Ht(i){return w(this,arguments,function*(t,{dpr:e=1,scale:r=1}={}){let c=new Image;c.src=t,c.crossOrigin="anonymous",c.loading="eager",c.decoding="sync";let a=Pt(),f=!1;if(a&&(document.body.appendChild(c),f=!0),yield c.decode(),a&&(yield new Promise(u=>setTimeout(u,100))),c.width===0||c.height===0)throw f&&c.remove(),new Error("Image failed to load or has no dimensions");let d=c.naturalWidth*r,n=c.naturalHeight*r,o=document.createElement("canvas");o.width=Math.ceil(d*e),o.height=Math.ceil(n*e),o.style.width=`${d}px`,o.style.height=`${n}px`;let m=o.getContext("2d");return m.scale(e,e),m.drawImage(c,0,0,d,n),f&&c.remove(),o})}function zt(a){return w(this,arguments,function*(t,{type:e="svg",scale:r=1,backgroundColor:i="#fff",quality:c}={}){let f={jpg:"image/jpeg",jpeg:"image/jpeg",png:"image/png",webp:"image/webp"}[e]||"image/png";if(e==="svg"){let n=decodeURIComponent(t.split(",")[1]);return new Blob([n],{type:"image/svg+xml"})}let d=yield bt(t,{dpr:1,scale:r},i);return new Promise(n=>{d.toBlob(o=>n(o),`${f}`,c)})})}function bt(c,a,f){return w(this,arguments,function*(t,{dpr:e=1,scale:r=1},i){let d=yield Ht(t,{dpr:e,scale:r});if(!i)return d;let n=document.createElement("canvas");n.width=d.width,n.height=d.height;let o=n.getContext("2d");return o.fillStyle=i,o.fillRect(0,0,n.width,n.height),o.drawImage(d,0,0),n})}function wt(f,d){return w(this,arguments,function*(t,{dpr:e=1,scale:r=1,backgroundColor:i,quality:c},a="png"){let n=["jpg","jpeg","webp"].includes(a)?"#fff":void 0,o=i!=null?i:n,m=yield bt(t,{dpr:e,scale:r},o),u=new Image;return u.src=m.toDataURL(`image/${a}`,c),yield u.decode(),u.style.width=`${m.width/e}px`,u.style.height=`${m.height/e}px`,u})}function me(f){return w(this,arguments,function*(t,{dpr:e=1,scale:r=1,backgroundColor:i,format:c="png",filename:a="snapDOM"}={}){if(c==="svg"){let s=yield zt(t),h=URL.createObjectURL(s),b=document.createElement("a");b.href=h,b.download=`${a}.svg`,b.click(),URL.revokeObjectURL(h);return}let d=["jpg","jpeg","webp"].includes(c)?"#fff":void 0,n=i!=null?i:d,o=yield bt(t,{dpr:e,scale:r},n),m={jpg:"image/jpeg",jpeg:"image/jpeg",png:"image/png",webp:"image/webp"}[c]||"image/png",u=o.toDataURL(m),l=document.createElement("a");l.href=u,l.download=`${a}.${c}`,l.click()})}function $(r){return w(this,arguments,function*(t,e={}){if(e=L({scale:1},e),!t)throw new Error("Element cannot be null or undefined");return e.iconFonts&&Ut(e.iconFonts),yield $.capture(t,e)})}$.capture=(r,...i)=>w(null,[r,...i],function*(t,e={}){var d;let c=yield Vt(t,e),a=(d=e.dpr)!=null?d:window.devicePixelRatio||1,f=e.scale||1;return{url:c,options:e,toRaw:()=>c,toImg:(n={})=>ue(c,L({dpr:a,scale:f},n)),toCanvas:(n={})=>Ht(c,L({dpr:a,scale:f},n)),toBlob:(n={})=>zt(c,L({dpr:a,scale:f},n)),toPng:(n={})=>wt(c,L({dpr:a,scale:f},n),"png"),toJpg:(n={})=>wt(c,L({dpr:a,scale:f},n),"jpeg"),toWebp:(n={})=>wt(c,L({dpr:a,scale:f},n),"webp"),download:(l={})=>{var s=l,{format:n="png",filename:o="snapDOM",backgroundColor:m}=s,u=ft(s,["format","filename","backgroundColor"]);return me(c,L({dpr:a,scale:f,format:n,filename:o,backgroundColor:m},u))}}});$.toRaw=(t,e)=>w(null,null,function*(){return(yield $.capture(t,e)).toRaw()});$.toImg=(t,e)=>w(null,null,function*(){return(yield $.capture(t,e)).toImg()});$.toCanvas=(t,e)=>w(null,null,function*(){return(yield $.capture(t,e)).toCanvas()});$.toBlob=(t,e)=>w(null,null,function*(){return(yield $.capture(t,e)).toBlob(e)});$.toPng=(t,e)=>w(null,null,function*(){return(yield $.capture(t,e)).toPng(e)});$.toJpg=(t,e)=>w(null,null,function*(){return(yield $.capture(t,e)).toJpg(e)});$.toWebp=(t,e)=>w(null,null,function*(){return(yield $.capture(t,e)).toWebp(e)});$.download=(r,...i)=>w(null,[r,...i],function*(t,e={}){let o=e,{format:c="png",filename:a="capture",backgroundColor:f}=o,d=ft(o,["format","filename","backgroundColor"]);return yield(yield $.capture(t,d)).download({format:c,filename:a,backgroundColor:f})});function Yt(){return w(this,arguments,function*(t=document,e={}){let{embedFonts:r=!0,reset:i=!1,useProxy:c}=e;if(i){p.image.clear(),p.background.clear(),p.resource.clear(),p.defaultStyle.clear(),p.baseStyle.clear(),p.font.clear(),p.computedStyle=new WeakMap;return}try{yield document.fonts.ready}catch(n){}It();let a=[],f=[];t!=null&&t.querySelectorAll&&(a=Array.from(t.querySelectorAll("img[src]")),f=Array.from(t.querySelectorAll("*")));let d=[];for(let n of a){let o=n==null?void 0:n.src;if(o&&!p.image.has(o)){let m=Promise.resolve().then(()=>_(o,{useProxy:c})).then(u=>{p.image.set(o,u)}).catch(()=>{});d.push(m)}}for(let n of f){let o="";try{o=D(n).backgroundImage}catch(m){}if(o&&o!=="none"){let m=Y(o);for(let u of m)if(u.startsWith("url(")){let l=Promise.resolve().then(()=>V(u,kt(L({},e),{useProxy:c}))).catch(()=>{});d.push(l)}}}if(r)try{yield at({preCached:!0,localFonts:e.localFonts,useProxy:e.useProxy})}catch(n){}yield Promise.allSettled(d)})}typeof window!="undefined"&&(window.snapdom=$,window.preCache=Yt);})();